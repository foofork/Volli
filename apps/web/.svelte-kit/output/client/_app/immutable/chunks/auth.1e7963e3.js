import{d,w as u}from"./index.045fc982.js";function y(){const{subscribe:r,set:n,update:i}=u({identity:null,device:null,isAuthenticated:!1,isLoading:!1,error:null});async function o(){i(t=>({...t,isLoading:!0,error:null}));try{const t=localStorage.getItem("volli_identity");if(t){const e=JSON.parse(t);i(a=>({...a,identity:e,isAuthenticated:!0,isLoading:!1}))}else i(e=>({...e,isLoading:!1}))}catch(t){i(e=>({...e,isLoading:!1,error:t instanceof Error?t.message:"Failed to initialize"}))}}async function l(t){i(e=>({...e,isLoading:!0,error:null}));try{const e={id:crypto.randomUUID(),publicKey:new Uint8Array(32),devices:[],createdAt:new Date,recoveryKey:new Uint8Array(32)},a={id:crypto.randomUUID(),name:t,publicKey:new Uint8Array(32),type:"primary",platform:"web",lastSeen:new Date,capabilities:["messaging","storage"]};localStorage.setItem("volli_identity",JSON.stringify(e)),localStorage.setItem("volli_device",JSON.stringify(a)),i(c=>({...c,identity:e,device:a,isAuthenticated:!0,isLoading:!1}))}catch(e){i(a=>({...a,isLoading:!1,error:e instanceof Error?e.message:"Failed to create identity"}))}}async function s(){localStorage.removeItem("volli_identity"),localStorage.removeItem("volli_device"),localStorage.removeItem("volli_vault_key"),n({identity:null,device:null,isAuthenticated:!1,isLoading:!1,error:null})}return{subscribe:r,initialize:o,createIdentity:l,logout:s}}const g=y(),m=d(g,r=>r.isAuthenticated);export{g as a,m as i};
//# sourceMappingURL=auth.1e7963e3.js.map
