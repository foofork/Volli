import{s as ie,n as B,e as q,o as oe,r as le}from"../chunks/scheduler.f21026e3.js";import{S as re,i as ce,g as k,h as w,j as T,f as v,k as d,a as x,s as U,y as H,c as N,x as u,A as P,m as S,n as A,C as z,D as ne,o as O,e as R,E as ae,z as Y}from"../chunks/index.887ba7b1.js";import{e as G}from"../chunks/each.3d878967.js";import{v as W}from"../chunks/vault.4a87f3ed.js";import{a as ue,m as L,b as fe}from"../chunks/messages.8ac05859.js";function X(a,e,s){const t=a.slice();return t[15]=e[s],t}function Z(a,e,s){const t=a.slice();return t[18]=e[s],t}function he(a){let e,s,t,l="Messages",i,n,m="+ New Chat",g,c,o,h,C,I;function E(r,b){return r[6].conversations.size===0?_e:de}let M=E(a),D=M(a);function y(r,b){return r[4]?pe:me}let f=y(a),p=f(a);return{c(){e=k("div"),s=k("div"),t=k("h2"),t.textContent=l,i=U(),n=k("button"),n.textContent=m,g=U(),c=k("div"),D.c(),o=U(),h=k("div"),p.c(),this.h()},l(r){e=w(r,"DIV",{class:!0});var b=T(e);s=w(b,"DIV",{class:!0});var _=T(s);t=w(_,"H2",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-ctbj3q"&&(t.textContent=l),i=N(_),n=w(_,"BUTTON",{class:!0,"data-svelte-h":!0}),H(n)!=="svelte-1cf5ts6"&&(n.textContent=m),_.forEach(v),g=N(b),c=w(b,"DIV",{class:!0});var V=T(c);D.l(V),V.forEach(v),b.forEach(v),o=N(r),h=w(r,"DIV",{class:!0});var j=T(h);p.l(j),j.forEach(v),this.h()},h(){d(t,"class","svelte-wfhbxs"),d(n,"class","new-chat svelte-wfhbxs"),d(s,"class","list-header svelte-wfhbxs"),d(c,"class","conversations svelte-wfhbxs"),d(e,"class","conversation-list svelte-wfhbxs"),d(h,"class","chat-view svelte-wfhbxs")},m(r,b){x(r,e,b),u(e,s),u(s,t),u(s,i),u(s,n),u(e,g),u(e,c),D.m(c,null),x(r,o,b),x(r,h,b),p.m(h,null),C||(I=P(n,"click",a[10]),C=!0)},p(r,b){M===(M=E(r))&&D?D.p(r,b):(D.d(1),D=M(r),D&&(D.c(),D.m(c,null))),f===(f=y(r))&&p?p.p(r,b):(p.d(1),p=f(r),p&&(p.c(),p.m(h,null)))},d(r){r&&(v(e),v(o),v(h)),D.d(),p.d(),C=!1,I()}}}function ve(a){let e,s,t,l="üîê Unlock Your Vault",i,n,m="Enter your passphrase to decrypt your messages",g,c,o,h,C,I,E=a[1]?"Unlocking...":"Unlock",M,D,y,f=a[3]&&se(a);return{c(){e=k("div"),s=k("div"),t=k("h2"),t.textContent=l,i=U(),n=k("p"),n.textContent=m,g=U(),c=k("form"),o=k("input"),h=U(),f&&f.c(),C=U(),I=k("button"),M=S(E),this.h()},l(p){e=w(p,"DIV",{class:!0});var r=T(e);s=w(r,"DIV",{class:!0});var b=T(s);t=w(b,"H2",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-bt5f60"&&(t.textContent=l),i=N(b),n=w(b,"P",{class:!0,"data-svelte-h":!0}),H(n)!=="svelte-jhmsas"&&(n.textContent=m),g=N(b),c=w(b,"FORM",{});var _=T(c);o=w(_,"INPUT",{type:!0,placeholder:!0,class:!0}),h=N(_),f&&f.l(_),C=N(_),I=w(_,"BUTTON",{type:!0,class:!0});var V=T(I);M=A(V,E),V.forEach(v),_.forEach(v),b.forEach(v),r.forEach(v),this.h()},h(){d(t,"class","svelte-wfhbxs"),d(n,"class","svelte-wfhbxs"),d(o,"type","password"),d(o,"placeholder","Enter passphrase"),o.disabled=a[1],d(o,"class","svelte-wfhbxs"),d(I,"type","submit"),I.disabled=a[1],d(I,"class","svelte-wfhbxs"),d(s,"class","unlock-card svelte-wfhbxs"),d(e,"class","unlock-container svelte-wfhbxs")},m(p,r){x(p,e,r),u(e,s),u(s,t),u(s,i),u(s,n),u(s,g),u(s,c),u(c,o),z(o,a[2]),u(c,h),f&&f.m(c,null),u(c,C),u(c,I),u(I,M),D||(y=[P(o,"input",a[12]),P(c,"submit",ne(a[8]))],D=!0)},p(p,r){r&2&&(o.disabled=p[1]),r&4&&o.value!==p[2]&&z(o,p[2]),p[3]?f?f.p(p,r):(f=se(p),f.c(),f.m(c,C)):f&&(f.d(1),f=null),r&2&&E!==(E=p[1]?"Unlocking...":"Unlock")&&O(M,E),r&2&&(I.disabled=p[1])},d(p){p&&v(e),f&&f.d(),D=!1,le(y)}}}function de(a){let e,s=G([...a[6].conversations.values()]),t=[];for(let l=0;l<s.length;l+=1)t[l]=ee(Z(a,s,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=R()},l(l){for(let i=0;i<t.length;i+=1)t[i].l(l);e=R()},m(l,i){for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(l,i);x(l,e,i)},p(l,i){if(i&2128){s=G([...l[6].conversations.values()]);let n;for(n=0;n<s.length;n+=1){const m=Z(l,s,n);t[n]?t[n].p(m,i):(t[n]=ee(m),t[n].c(),t[n].m(e.parentNode,e))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(l){l&&v(e),ae(t,l)}}}function _e(a){let e,s,t="No conversations yet",l,i,n="Start a conversation",m,g;return{c(){e=k("div"),s=k("p"),s.textContent=t,l=U(),i=k("button"),i.textContent=n,this.h()},l(c){e=w(c,"DIV",{class:!0});var o=T(e);s=w(o,"P",{"data-svelte-h":!0}),H(s)!=="svelte-jchknb"&&(s.textContent=t),l=N(o),i=w(o,"BUTTON",{class:!0,"data-svelte-h":!0}),H(i)!=="svelte-1h30l3q"&&(i.textContent=n),o.forEach(v),this.h()},h(){d(i,"class","svelte-wfhbxs"),d(e,"class","empty-state svelte-wfhbxs")},m(c,o){x(c,e,o),u(e,s),u(e,l),u(e,i),m||(g=P(i,"click",a[10]),m=!0)},p:B,d(c){c&&v(e),m=!1,g()}}}function $(a){let e,s=J(a[18].updatedAt)+"",t;return{c(){e=k("div"),t=S(s),this.h()},l(l){e=w(l,"DIV",{class:!0});var i=T(e);t=A(i,s),i.forEach(v),this.h()},h(){d(e,"class","conversation-time svelte-wfhbxs")},m(l,i){x(l,e,i),u(e,t)},p(l,i){i&64&&s!==(s=J(l[18].updatedAt)+"")&&O(t,s)},d(l){l&&v(e)}}}function ee(a){let e,s,t="üí¨",l,i,n,m=a[18].metadata.name+"",g,c,o,h=(a[18].lastMessage?a[18].lastMessage.content.text:"No messages yet")+"",C,I,E,M,D,y=a[18].updatedAt&&$(a);function f(){return a[13](a[18])}return{c(){e=k("button"),s=k("div"),s.textContent=t,l=U(),i=k("div"),n=k("div"),g=S(m),c=U(),o=k("div"),C=S(h),I=U(),y&&y.c(),E=U(),this.h()},l(p){e=w(p,"BUTTON",{class:!0});var r=T(e);s=w(r,"DIV",{class:!0,"data-svelte-h":!0}),H(s)!=="svelte-reudcj"&&(s.textContent=t),l=N(r),i=w(r,"DIV",{class:!0});var b=T(i);n=w(b,"DIV",{class:!0});var _=T(n);g=A(_,m),_.forEach(v),c=N(b),o=w(b,"DIV",{class:!0});var V=T(o);C=A(V,h),V.forEach(v),b.forEach(v),I=N(r),y&&y.l(r),E=N(r),r.forEach(v),this.h()},h(){d(s,"class","conversation-avatar svelte-wfhbxs"),d(n,"class","conversation-name svelte-wfhbxs"),d(o,"class","conversation-preview svelte-wfhbxs"),d(i,"class","conversation-details svelte-wfhbxs"),d(e,"class","conversation-item svelte-wfhbxs"),Y(e,"active",a[4]?.id===a[18].id)},m(p,r){x(p,e,r),u(e,s),u(e,l),u(e,i),u(i,n),u(n,g),u(i,c),u(i,o),u(o,C),u(e,I),y&&y.m(e,null),u(e,E),M||(D=P(e,"click",f),M=!0)},p(p,r){a=p,r&64&&m!==(m=a[18].metadata.name+"")&&O(g,m),r&64&&h!==(h=(a[18].lastMessage?a[18].lastMessage.content.text:"No messages yet")+"")&&O(C,h),a[18].updatedAt?y?y.p(a,r):(y=$(a),y.c(),y.m(e,E)):y&&(y.d(1),y=null),r&80&&Y(e,"active",a[4]?.id===a[18].id)},d(p){p&&v(e),y&&y.d(),M=!1,D()}}}function me(a){let e,s='<h2 class="svelte-wfhbxs">Select a conversation</h2> <p>Choose a conversation from the list or start a new one</p>';return{c(){e=k("div"),e.innerHTML=s,this.h()},l(t){e=w(t,"DIV",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1bwf5li"&&(e.innerHTML=s),this.h()},h(){d(e,"class","no-conversation svelte-wfhbxs")},m(t,l){x(t,e,l)},p:B,d(t){t&&v(e)}}}function pe(a){let e,s,t=a[4].metadata.name+"",l,i,n,m='<button class="icon-button" title="Call">üìû</button> <button class="icon-button" title="Info">‚ÑπÔ∏è</button>',g,c,o,h,C,I,E,M,D,y,f;function p(_,V){return _[7].length===0?ke:be}let r=p(a),b=r(a);return{c(){e=k("div"),s=k("h3"),l=S(t),i=U(),n=k("div"),n.innerHTML=m,g=U(),c=k("div"),b.c(),o=U(),h=k("form"),C=k("input"),I=U(),E=k("button"),M=S("Send"),this.h()},l(_){e=w(_,"DIV",{class:!0});var V=T(e);s=w(V,"H3",{class:!0});var j=T(s);l=A(j,t),j.forEach(v),i=N(V),n=w(V,"DIV",{class:!0,"data-svelte-h":!0}),H(n)!=="svelte-s4e3tr"&&(n.innerHTML=m),V.forEach(v),g=N(_),c=w(_,"DIV",{class:!0});var K=T(c);b.l(K),K.forEach(v),o=N(_),h=w(_,"FORM",{class:!0});var F=T(h);C=w(F,"INPUT",{type:!0,placeholder:!0,class:!0}),I=N(F),E=w(F,"BUTTON",{type:!0,class:!0});var Q=T(E);M=A(Q,"Send"),Q.forEach(v),F.forEach(v),this.h()},h(){d(s,"class","svelte-wfhbxs"),d(n,"class","chat-actions svelte-wfhbxs"),d(e,"class","chat-header svelte-wfhbxs"),d(c,"class","messages-container svelte-wfhbxs"),d(C,"type","text"),d(C,"placeholder","Type a secure message..."),d(C,"class","svelte-wfhbxs"),d(E,"type","submit"),E.disabled=D=!a[0].trim(),d(E,"class","svelte-wfhbxs"),d(h,"class","message-input svelte-wfhbxs")},m(_,V){x(_,e,V),u(e,s),u(s,l),u(e,i),u(e,n),x(_,g,V),x(_,c,V),b.m(c,null),x(_,o,V),x(_,h,V),u(h,C),z(C,a[0]),u(h,I),u(h,E),u(E,M),y||(f=[P(C,"input",a[14]),P(h,"submit",ne(a[9]))],y=!0)},p(_,V){V&16&&t!==(t=_[4].metadata.name+"")&&O(l,t),r===(r=p(_))&&b?b.p(_,V):(b.d(1),b=r(_),b&&(b.c(),b.m(c,null))),V&1&&C.value!==_[0]&&z(C,_[0]),V&1&&D!==(D=!_[0].trim())&&(E.disabled=D)},d(_){_&&(v(e),v(g),v(c),v(o),v(h)),b.d(),y=!1,le(f)}}}function be(a){let e,s=G(a[7]),t=[];for(let l=0;l<s.length;l+=1)t[l]=te(X(a,s,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=R()},l(l){for(let i=0;i<t.length;i+=1)t[i].l(l);e=R()},m(l,i){for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(l,i);x(l,e,i)},p(l,i){if(i&128){s=G(l[7]);let n;for(n=0;n<s.length;n+=1){const m=X(l,s,n);t[n]?t[n].p(m,i):(t[n]=te(m),t[n].c(),t[n].m(e.parentNode,e))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(l){l&&v(e),ae(t,l)}}}function ke(a){let e,s='<p class="svelte-wfhbxs">üîí Messages are end-to-end encrypted</p> <p class="svelte-wfhbxs">Start a conversation</p>';return{c(){e=k("div"),e.innerHTML=s,this.h()},l(t){e=w(t,"DIV",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1bv9t29"&&(e.innerHTML=s),this.h()},h(){d(e,"class","empty-chat svelte-wfhbxs")},m(t,l){x(t,e,l)},p:B,d(t){t&&v(e)}}}function te(a){let e,s,t=a[15].content.text+"",l,i,n,m=J(a[15].timestamp)+"",g,c;return{c(){e=k("div"),s=k("div"),l=S(t),i=U(),n=k("div"),g=S(m),c=U(),this.h()},l(o){e=w(o,"DIV",{class:!0});var h=T(e);s=w(h,"DIV",{class:!0});var C=T(s);l=A(C,t),C.forEach(v),i=N(h),n=w(h,"DIV",{class:!0});var I=T(n);g=A(I,m),I.forEach(v),c=N(h),h.forEach(v),this.h()},h(){d(s,"class","message-bubble svelte-wfhbxs"),d(n,"class","message-time svelte-wfhbxs"),d(e,"class","message svelte-wfhbxs"),Y(e,"sent",a[15].senderId==="current-user")},m(o,h){x(o,e,h),u(e,s),u(s,l),u(e,i),u(e,n),u(n,g),u(e,c)},p(o,h){h&128&&t!==(t=o[15].content.text+"")&&O(l,t),h&128&&m!==(m=J(o[15].timestamp)+"")&&O(g,m),h&128&&Y(e,"sent",o[15].senderId==="current-user")},d(o){o&&v(e)}}}function se(a){let e,s;return{c(){e=k("div"),s=S(a[3]),this.h()},l(t){e=w(t,"DIV",{class:!0});var l=T(e);s=A(l,a[3]),l.forEach(v),this.h()},h(){d(e,"class","error svelte-wfhbxs")},m(t,l){x(t,e,l),u(e,s)},p(t,l){l&8&&O(s,t[3])},d(t){t&&v(e)}}}function we(a){let e;function s(i,n){return i[5].isUnlocked?he:ve}let t=s(a),l=t(a);return{c(){e=k("div"),l.c(),this.h()},l(i){e=w(i,"DIV",{class:!0});var n=T(e);l.l(n),n.forEach(v),this.h()},h(){d(e,"class","messages-layout svelte-wfhbxs")},m(i,n){x(i,e,n),l.m(e,null)},p(i,[n]){t===(t=s(i))&&l?l.p(i,n):(l.d(1),l=t(i),l&&(l.c(),l.m(e,null)))},i:B,o:B,d(i){i&&v(e),l.d()}}}function J(a){return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).format(a)}function ge(a,e,s){let t,l,i,n;q(a,ue,f=>s(4,t=f)),q(a,W,f=>s(5,l=f)),q(a,L,f=>s(6,i=f)),q(a,fe,f=>s(7,n=f));let m="",g=!1,c="",o="";oe(()=>{l.isUnlocked&&L.loadConversations()});async function h(){if(!c){s(3,o="Please enter a passphrase");return}s(1,g=!0),s(3,o="");try{await W.unlock(c),await L.loadConversations(),s(2,c="")}catch(f){s(3,o=f instanceof Error?f.message:"Failed to unlock vault")}finally{s(1,g=!1)}}async function C(){if(!m.trim()||!t)return;const f={type:"text",text:m.trim()};await L.sendMessage(t.id,f),s(0,m="")}async function I(){const f=await L.createConversation(["demo-user"],"Demo Chat");L.setActiveConversation(f)}function E(f){L.setActiveConversation(f)}function M(){c=this.value,s(2,c)}const D=f=>E(f.id);function y(){m=this.value,s(0,m)}return[m,g,c,o,t,l,i,n,h,C,I,E,M,D,y]}class Ve extends re{constructor(e){super(),ce(this,e,ge,we,ie,{})}}export{Ve as component};
//# sourceMappingURL=4.a632d811.js.map
